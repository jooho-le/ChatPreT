# AI 발표 리허설 코치 (웹 프론트엔드 템플릿)

전문적인 분위기의 단일 페이지 웹앱으로, 발표 리허설 음성을 받아 실시간 피드백(속도, 군말, 억양 대략치)과 세션 종료 후 종합 리포트를 제공합니다. 백엔드/LLM 연동 지점을 명확히 분리해 두었습니다.

## 실행 방법
- 별도 빌드 없이 `index.html`을 브라우저로 열면 됩니다.
- 로컬 파일로 열거나 간단한 정적 서버(`python -m http.server`)로 서빙해도 됩니다.

## 주요 파일
- `index.html`: 레이아웃(헤더, 채팅, 라이브 피드백, 리포트)
- `styles.css`: 블랙 & 화이트 미니멀 테마
- `app.js`: 음성 녹음/분석, 채팅 흐름, 리포트 생성, 백엔드 훅
- `prompts/PromptTemplates.md`: 프롬프트 엔지니어링 템플릿(시스템/지침/루브릭)
- `prompts/OperationalPrinciples.md`: 운영 원칙·평가 기준(내장 프롬프트 요약)
- `server/`: Node/Express 백엔드(API 스텁: /api/chat, /api/report, /api/stream)

## 기능 개요
- 리허설 시작/종료: 마이크로폰 녹음, 레벨 미터, 타이머 표시
- 실시간 지표: WPM(대략), 군말 카운트/분당, 억양 다양성(파형 분산 기반 대략치), 참고 자료 일치율(키워드 커버리지)
- 채팅: 사용자 메시지 → 코치 응답(모형 연동 지점 제공, 현재 규칙 기반 Fallback)
- 리포트: 점수(0–100), 핵심 지표, 권장 수정 사항, JSON 복사/다운로드
- 로그인/회원가입/프로필(로컬 저장소 기반 템플릿): 생성/조회/수정/삭제 기본 흐름 포함
- 프롬프트 편집기: 시스템/지침/루브릭 설정을 로컬에 저장하고 코치 응답에 반영
- 세그먼트 코칭: 자연스러운 정지/무음 기반 구간 분할(10초 이상 + 0.8초 정지), 중간 피드백 트리거("중간 피드백" 등)
- 엄격한 평가표: 세부 진단표(10점 만점)와 정확 포인트 코칭(타임스탬프/인용) 추가

## 백엔드/LLM 연동 포인트
`app.js` 내 함수만 교체하면 됩니다.

- 텍스트 채팅
  - 함수: `sendChatToBackend(userText, context)`
  - 입력 예: `{ user: string, context: { metrics, reference } }`
  - 출력 예: `string` (코치의 텍스트 응답)
  - 기본값: 서버(`/api/chat`) 우선, 실패 시 로컬 규칙 기반(`composeCoachResponse`)

- 오디오 스트리밍(선택)
  - 함수: `sendAudioChunk(blob, seq)`
  - `MediaRecorder`가 1초 간격으로 WebM 오디오 조각을 전달함
  - 서버에서 스트리밍 STT/분석을 수행하려면 해당 함수에서 `fetch('/api/stream', FormData)`로 전송

- 음성 인식(클라이언트 기반 옵션)
  - Web Speech API(`SpeechRecognition`) 사용. 브라우저/플랫폼 별 지원 상이
  - 서버 기반 STT로 대체하려면 `pushTranscript(text)`를 서버 전사 결과로 주기적으로 호출

## 참고: 지표 산출 로직(단순화)
- 속도(WPM): 공백 토큰 기반 근사. 한국어에 완벽하지 않으나 실시간 지표로 유용
- 군말: 지정 리스트에 대한 단순 매칭. `state.fillers`에서 커스터마이즈
- 억양 다양성: 파형 분산 기반 0–100 스케일 근사치(실제 피치/억양 분석은 서버에서 권장)
- 자료 일치: 참고 텍스트의 키워드 집합 대비 포함 비율(단순 커버리지)

## 디자인/UX
- 블랙 & 화이트 미니멀 톤, 카드형 지표, 미니멀 채팅 UI
- 반응형(모바일/태블릿): 단일 열 레이아웃으로 변환

## 인증(템플릿)
- 현재는 로컬스토리지 기반 예시입니다. 실제 운영 환경에서는 서버 인증(JWT/세션)으로 교체하세요.
- 교체 포인트: `signup`, `login`, `logout`, `currentUser`, `updateProfile`, `deleteAccount` (app.js)

## 서버 실행
1) Node.js 18+ 설치
2) `cd server && npm install`
3) `npm run dev` (기본 포트 8787)
4) 정적 프론트엔드를 같은 포트에서 서빙하거나, 프록시 설정으로 `/api/*`를 서버에 연결하세요.

## OpenAI 연동과 API 키 위치
- 키 위치: `server/.env` 파일의 `OPENAI_API_KEY`에 값을 넣으세요.
- 모델 선택: 같은 파일의 `COACH_MODEL`로 지정(예: `gpt-4o-mini`).
- 보안: 실제 키는 절대 VCS에 커밋하지 마세요. `server/.gitignore`에 `.env`가 포함되어 있습니다.
- 동작: 프론트는 `/api/chat` 호출 → 서버는 OpenAI가 설정되어 있으면 LLM으로 응답, 없으면 로컬 규칙 기반으로 폴백.

## 프롬프트(시스템) 소스
- 파일: `prompts/SystemPrompt_ko.txt` (사용자 제공 원칙·루브릭 포함)
- 서버는 해당 파일이 있으면 우선적으로 읽어 시스템 프롬프트로 사용합니다. 없으면 내장 기본 프롬프트 사용.

## 주의 사항
- 브라우저 마이크 권한 필요
- Web Speech API는 일부 환경에서 미지원. 이 경우 서버 기반 STT로 대체 권장
- 본 템플릿은 프런트엔드만 포함. 실제 LLM/심층 분석은 서버에서 구현/연동 필요

---
원하시면 서버 API 스펙/예시(Express/FastAPI)와 STT/분석 파이프라인 템플릿도 추가해 드립니다.
