<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI 발표 리허설 코치</title>
    <meta name="color-scheme" content="light dark" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="brand">
        <div class="logo" aria-hidden="true">🎤</div>
        <div class="title">AI 발표 리허설 코치</div>
      </div>
      <div class="session-controls">
        <button id="btnToggleRehearsal" class="btn btn-primary">리허설 시작</button>
        <button id="btnToggleMic" class="btn" title="채팅 입력 음성 인식 토글">🎙️</button>
        <div class="status">
          <span id="recStatusDot" class="dot"></span>
          <span id="recTimer">00:00</span>
        </div>
      </div>
      <div class="user-controls">
        <div id="authAreaLoggedOut">
          <button id="btnOpenLogin" class="btn">로그인</button>
          <button id="btnOpenSignup" class="btn">회원가입</button>
        </div>
        <div id="authAreaLoggedIn" class="user" style="display:none">
          <button id="btnUser" class="btn">👤 <span id="userDisplayName">사용자</span></button>
          <div id="userMenu" class="user-menu">
            <button id="btnOpenProfile" class="btn">프로필 관리</button>
            <button id="btnLogout" class="btn">로그아웃</button>
          </div>
        </div>
      </div>
    </header>

    <main class="layout layout-stack">
      <div class="row top-row">
        <section class="panel panel-left" aria-label="대화와 자료">
        <div class="chat-hero">
          <h2>코치에게 바로 말 걸어보세요</h2>
          <p>“이번 발표는 공모전이에요”처럼 대화를 시작하면, 바로 맞춤 코칭 시나리오가 세팅됩니다.</p>
          <div class="hero-tags">
            <span>목적</span>
            <span>형태</span>
            <span>시간</span>
            <span>핵심 메시지</span>
            <span>강점/보완</span>
          </div>
        </div>

        <div class="chat-panel">
          <div class="chat" id="chat">
            <!-- Messages injected here -->
          </div>

          <div class="ref-box simple compact">
            <label for="referenceText">발표 핵심 메모 (선택)</label>
            <textarea id="referenceText" placeholder="슬라이드 제목, 핵심 메시지, 꼭 언급해야 할 수치를 적어두면 일치도를 체크해 드립니다."></textarea>
          </div>

          <form id="chatForm" class="chat-input" autocomplete="off">
            <input id="chatInput" type="text" placeholder="메시지를 입력하거나, 리허설을 시작하세요." />
            <button class="btn btn-primary" id="btnSend" type="submit">보내기</button>
          </form>
        </div>
        </section>

        <section class="panel panel-right" aria-label="세션 리포트">
          <div class="report report-inline">
          <h3>세션 리포트</h3>
          <div class="report-grid">
            <div class="report-card score">
              <div class="score-circle">
                <span id="reportScoreValue">--</span>
                <small>/100</small>
              </div>
              <p id="reportScoreMessage">리허설 종료 후 점수가 표시됩니다.</p>
            </div>
            <div class="report-card metrics">
              <h4>주요 수치</h4>
              <dl>
                <div><dt>속도</dt><dd id="reportMetricSpeed">-</dd></div>
                <div><dt>군말</dt><dd id="reportMetricFillers">-</dd></div>
                <div><dt>억양 다양성</dt><dd id="reportMetricProsody">-</dd></div>
                <div><dt>자료 일치</dt><dd id="reportMetricAlign">-</dd></div>
              </dl>
            </div>
            <div class="report-card criteria">
              <h4>세부 진단표</h4>
              <ul id="reportCriteriaList" class="criteria-list">
                <li>리허설 종료 후 항목별 점수가 제공됩니다.</li>
              </ul>
            </div>
            <div class="report-card pointers">
              <h4>정확 포인트</h4>
              <ol id="reportPointersList" class="pointer-list">
                <li>타임스탬프와 함께 개선 아이디어가 여기에 표시됩니다.</li>
              </ol>
            </div>
          </div>
            <div class="report-card next">
              <h4>다음 단계</h4>
              <p id="reportNextLoop">리허설을 완료하면 추천 루프와 행동 가이드가 나타납니다.</p>
              <ul id="reportRecommendations" class="recommend-list">
                <li>리허설 종료 후 권장 수정 사항이 안내됩니다.</li>
              </ul>
            </div>
            <div class="report-actions">
              <button id="btnCopyReport" class="btn">JSON 복사</button>
              <button id="btnDownloadReport" class="btn">다운로드</button>
            </div>
          </div>
        </section>
      </div>

      <div class="row bottom-row">
        <section class="panel panel-wide" aria-label="라이브 피드백">
          <h2>라이브 피드백</h2>
          <div class="cards">
            <div class="card">
              <div class="card-title">말 속도</div>
              <div class="metric-big"><span id="wpm">-</span> WPM</div>
              <div class="gauge">
                <div id="paceGauge" class="gauge-fill"></div>
              </div>
              <div class="hint" id="paceHint">권장 130–160 WPM</div>
            </div>
            <div class="card">
              <div class="card-title">군말</div>
              <div class="metric"><span id="fillerCount">-</span>회 (<span id="fillerPerMin">-</span>/분)</div>
              <div class="hint" id="fillerHint">어, 음, 그.. 등</div>
            </div>
            <div class="card">
              <div class="card-title">억양/강세 다양성</div>
              <div class="metric"><span id="prosodyVar">-</span></div>
              <div class="bar">
                <div id="prosodyBar" class="bar-fill"></div>
              </div>
              <div class="hint">단조로움 방지: 문장 끝 강조</div>
            </div>
            <div class="card">
              <div class="card-title">참고 자료 일치</div>
              <div class="metric"><span id="alignment">-</span>%</div>
              <div class="hint">핵심 키워드 커버리지</div>
            </div>
          </div>

          <div class="live-audio">
            <canvas id="levelMeter" width="360" height="32" aria-label="오디오 레벨 미터"></canvas>
          </div>
        </section>

        <section class="panel panel-guide" aria-label="리허설 흐름">
          <div class="guide-card">
          <div>
            <p class="tag">리허설 흐름</p>
            <h3>마이크를 켜고 “시작하겠습니다”라고 말해보세요.</h3>
            <p class="lead">중간에 “중간 피드백”이라고 말하면 지금 구간만 빠르게 피드백드려요. 끝낼 땐 “리허설 끝/여기까지”.</p>
          </div>
          <div class="chip-list">
            <span class="chip">중간 피드백</span>
            <span class="chip">잠깐</span>
            <span class="chip">리허설 끝</span>
            <span class="chip">여기까지</span>
          </div>
        </div>
        </section>
      </div>
    </main>
    </main>



    <!-- 로그인 모달 -->
    <div id="modalLogin" class="modal" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
      <div class="dialog">
        <h3 id="loginTitle">로그인</h3>
        <form id="formLogin">
          <input id="loginEmail" type="email" placeholder="이메일" required />
          <input id="loginPassword" type="password" placeholder="비밀번호" required />
          <div class="actions">
            <button type="button" class="btn" id="closeLogin">취소</button>
            <button type="submit" class="btn btn-primary">로그인</button>
          </div>
        </form>
      </div>
    </div>

    <!-- 회원가입 모달 -->
    <div id="modalSignup" class="modal" role="dialog" aria-modal="true" aria-labelledby="signupTitle">
      <div class="dialog">
        <h3 id="signupTitle">회원가입</h3>
        <form id="formSignup">
          <input id="signupName" type="text" placeholder="표시 이름" required />
          <input id="signupEmail" type="email" placeholder="이메일" required />
          <input id="signupPassword" type="password" placeholder="비밀번호(최소 6자)" minlength="6" required />
          <div class="actions">
            <button type="button" class="btn" id="closeSignup">취소</button>
            <button type="submit" class="btn btn-primary">가입</button>
          </div>
        </form>
      </div>
    </div>

    <!-- 프로필 관리 모달 -->
    <div id="modalProfile" class="modal" role="dialog" aria-modal="true" aria-labelledby="profileTitle">
      <div class="dialog">
        <h3 id="profileTitle">프로필 관리</h3>
        <form id="formProfile">
          <input id="profileName" type="text" placeholder="표시 이름" required />
          <input id="profileEmail" type="email" placeholder="이메일" disabled />
          <input id="profilePassword" type="password" placeholder="새 비밀번호(선택)" minlength="6" />
          <div class="actions">
            <button type="button" class="btn" id="btnDeleteAccount">계정 삭제</button>
            <span style="flex:1"></span>
            <button type="button" class="btn" id="closeProfile">닫기</button>
            <button type="submit" class="btn btn-primary">저장</button>
          </div>
        </form>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
  </html>
