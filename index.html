<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI 발표 리허설 코치</title>
    <meta name="color-scheme" content="light dark" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="brand">
        <div class="logo" aria-hidden="true">🎤</div>
        <div class="title">AI 발표 리허설 코치</div>
      </div>
      <div class="session-controls">
        <button id="btnToggleRehearsal" class="btn btn-primary">리허설 시작</button>
        <button id="btnToggleMic" class="btn" title="채팅 입력 음성 인식 토글">🎙️</button>
        <div class="status">
          <span id="recStatusDot" class="dot"></span>
          <span id="recTimer">00:00</span>
        </div>
      </div>
      <div class="user-controls">
        <div id="authAreaLoggedOut">
          <button id="btnOpenLogin" class="btn">로그인</button>
          <button id="btnOpenSignup" class="btn">회원가입</button>
        </div>
        <div id="authAreaLoggedIn" class="user" style="display:none">
          <button id="btnUser" class="btn">👤 <span id="userDisplayName">사용자</span></button>
          <div id="userMenu" class="user-menu">
            <button id="btnOpenProfile" class="btn">프로필 관리</button>
            <button id="btnLogout" class="btn">로그아웃</button>
          </div>
        </div>
      </div>
    </header>

    <main class="layout">
      <section class="panel panel-left" aria-label="대화와 자료">
        <div class="ref-box">
          <details>
            <summary>발표 참고 자료 입력(선택)</summary>
            <textarea id="referenceText" placeholder="핵심 포인트, 아젠다, 주장/근거 등을 간략히 입력하세요."></textarea>
          </details>
          <details style="margin-top:8px;">
            <summary>프롬프트 엔지니어링 설정</summary>
            <div style="display:grid; gap:6px; margin-top:8px;">
              <label>시스템 프롬프트</label>
              <textarea id="promptSystem" placeholder="코치의 역할, 톤, 목표를 명시하세요." style="height:88px"></textarea>
              <label>지침(스타일/제한/형식)</label>
              <textarea id="promptGuidelines" placeholder="불필요한 수식어 금지, 수치 제시, 단계별 피드백 등" style="height:72px"></textarea>
              <label>평가 루브릭</label>
              <textarea id="promptRubric" placeholder="속도, 군말, 억양, 논리, 일치성 각각의 기준과 가중치" style="height:72px"></textarea>
              <div>
                <button id="btnSavePrompts" class="btn">프롬프트 저장</button>
              </div>
            </div>
          </details>
        </div>

        <div class="chat" id="chat">
          <!-- Messages injected here -->
        </div>

        <form id="chatForm" class="chat-input" autocomplete="off">
          <input id="chatInput" type="text" placeholder="메시지를 입력하거나, 리허설을 시작하세요." />
          <button class="btn btn-primary" id="btnSend" type="submit">보내기</button>
        </form>
      </section>

      <aside class="panel panel-right" aria-label="라이브 피드백">
        <h2>라이브 피드백</h2>
        <div class="cards">
          <div class="card">
            <div class="card-title">말 속도</div>
            <div class="metric-big"><span id="wpm">-</span> WPM</div>
            <div class="gauge">
              <div id="paceGauge" class="gauge-fill"></div>
            </div>
            <div class="hint" id="paceHint">권장 130–160 WPM</div>
          </div>
          <div class="card">
            <div class="card-title">군말</div>
            <div class="metric"><span id="fillerCount">-</span>회 (<span id="fillerPerMin">-</span>/분)</div>
            <div class="hint" id="fillerHint">어, 음, 그.. 등</div>
          </div>
          <div class="card">
            <div class="card-title">억양/강세 다양성</div>
            <div class="metric"><span id="prosodyVar">-</span></div>
            <div class="bar">
              <div id="prosodyBar" class="bar-fill"></div>
            </div>
            <div class="hint">단조로움 방지: 문장 끝 강조</div>
          </div>
          <div class="card">
            <div class="card-title">참고 자료 일치</div>
            <div class="metric"><span id="alignment">-</span>%</div>
            <div class="hint">핵심 키워드 커버리지</div>
          </div>
        </div>

        <div class="live-audio">
          <canvas id="levelMeter" width="360" height="32" aria-label="오디오 레벨 미터"></canvas>
        </div>

        <div class="report">
          <h3>세션 리포트</h3>
          <div id="reportSummary" class="report-summary">리허설 종료 후 자동 생성됩니다.</div>
          <div class="report-actions">
            <button id="btnCopyReport" class="btn">복사</button>
            <button id="btnDownloadReport" class="btn">다운로드</button>
          </div>
        </div>
      </aside>
    </main>



    <!-- 로그인 모달 -->
    <div id="modalLogin" class="modal" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
      <div class="dialog">
        <h3 id="loginTitle">로그인</h3>
        <form id="formLogin">
          <input id="loginEmail" type="email" placeholder="이메일" required />
          <input id="loginPassword" type="password" placeholder="비밀번호" required />
          <div class="actions">
            <button type="button" class="btn" id="closeLogin">취소</button>
            <button type="submit" class="btn btn-primary">로그인</button>
          </div>
        </form>
      </div>
    </div>

    <!-- 회원가입 모달 -->
    <div id="modalSignup" class="modal" role="dialog" aria-modal="true" aria-labelledby="signupTitle">
      <div class="dialog">
        <h3 id="signupTitle">회원가입</h3>
        <form id="formSignup">
          <input id="signupName" type="text" placeholder="표시 이름" required />
          <input id="signupEmail" type="email" placeholder="이메일" required />
          <input id="signupPassword" type="password" placeholder="비밀번호(최소 6자)" minlength="6" required />
          <div class="actions">
            <button type="button" class="btn" id="closeSignup">취소</button>
            <button type="submit" class="btn btn-primary">가입</button>
          </div>
        </form>
      </div>
    </div>

    <!-- 프로필 관리 모달 -->
    <div id="modalProfile" class="modal" role="dialog" aria-modal="true" aria-labelledby="profileTitle">
      <div class="dialog">
        <h3 id="profileTitle">프로필 관리</h3>
        <form id="formProfile">
          <input id="profileName" type="text" placeholder="표시 이름" required />
          <input id="profileEmail" type="email" placeholder="이메일" disabled />
          <input id="profilePassword" type="password" placeholder="새 비밀번호(선택)" minlength="6" />
          <div class="actions">
            <button type="button" class="btn" id="btnDeleteAccount">계정 삭제</button>
            <span style="flex:1"></span>
            <button type="button" class="btn" id="closeProfile">닫기</button>
            <button type="submit" class="btn btn-primary">저장</button>
          </div>
        </form>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
  </html>
